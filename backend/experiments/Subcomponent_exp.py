import spacy
import csv

nlp = spacy.load("en_core_web_sm")

# Reqs taken from Voyager, E-store, Capterra - microsft outlook, Thesis examples, google.
requirements = [
    #Voyager
    "The user should be able to see the price, location, accessibility, child friendliness, adult friendliness, among others, regarding each experience.",
    "When the user presses an ’Experience’, the app should display pictures and information about the ’Experience’.",
    "The user should be able to register for a user-profile with the following methods: Facebook, Google or email and password.",
    "The user should be able to navigate between attractions from a map of Copenhagen.",
    "The user should be able to view all experiences near them on a map of Copenhagen.",
    "The user should be able to save an itinerary generated by creating a user-profile and adding it to their profile.",
    "The user should be able to filter which experiences they can see on the map of Copenhagen, based on the following labels: CHILD FRIENDLY, ROMANTIC, POPULAR, UNIQUE, LOCAL, ACTIVE, CULTURE, NATURE, HISTORIC.",
    "The user should be able to edit the itinerary, add their own experiences, and delete or move recommended experiences.",
    "The user should be able to access all services without a user profile.",
    "The user should be able to add their own experience, with location, perceived price range, pictures and text.",
    "The user should be able to create and save multiple itineraries to their user profile.",
    "The user should be able to access a overview of all their itineraries.",
    #E-store
    "The system shall display all the products that can be configured.",
    "The system shall allow user to select the product to configure.",
    "The system shall display all the available components of the product to configure.",
    "The system shall enable user to add one or more component to the configuration.",
    "The system shall notify the user about any conflict in the current configuration.",
    "The system shall allow user to update the configuration to resolve conflict in the current configuration.",
    "The system shall allow user to confirm the completion of current configuration.",
    "The system shall display detailed information of the selected products.",
    "The system shall provide browsing options to see product details.",
    "The system shall display detailed product categorization to the user.",
    "The system shall enable user to enter the search text on the screen.",
    "The system shall enable user to select multiple options on the screen to search.",
    "The system shall display all the matching products based on the search.",
    "The system shall display only 10 matching result on the current screen.",
    "The system shall enable user to navigate between the search results.",
    "The system shall notify the user when no matching product is found on the search.",
    "The system shall allow user to create profile and set his credential.",
    "The system shall authenticate user credentials to view the profile.",
    "The system shall allow user to update the profile information.",
    "The system shall display both the active and completed order history in the customer profile.",
    "The system shall allow user to select the order from the order history.",
    "The system shall display the detailed information about the selected order.",
    "The system shall display the most frequently searched items by the user in the profile.",
    "The system shall allow user to register for newsletters and surveys in the profile.",
    "The system shall provide online help, FAQ’s customer support, and sitemap options for customer support.",
    "The system shall allow user to select the support type he wants.",
    "The system shall allow user to enter the customer and product information for the support.",
    "The system shall display the customer support contact numbers on the screen.",
    "The system shall allow user to enter the contact number for support personnel to call.",
    "The system shall display the online help upon request.",
    "The system shall display the FAQ’s upon request.",
    "The system shall maintain customer email information as a required part of customer profile.",
    "The system shall send an order confirmation to the user through email.",
    "The system shall display detailed invoice for current order once it is confirmed.",
    "The system shall optionally allow user to print the invoice.",
    "The system shall provide shopping cart during online purchase.",
    "The system shall allow user to add/remove products in the shopping cart.",
    "The system shall display different shipping options provided by shipping department.",
    "The system shall enable user to select the shipping method during payment process.",
    "The system shall display the shipping charges.",
    "The system shall display tentative duration for shipping.",
    "The system shall allow user to enter the order information for tracking.",
    "The system shall display the current tracking information about the order.",
    "The system shall calculate tax for the order.",
    "The system shall display tax information for the order.",
    "The system shall display available payment methods for payment.",
    "The system shall allow user to select the payment method for order.",
    "The system shall display the orders that are eligible to change.",
    "The system shall allow user to select the order to be changed.",
    "The system shall allow user to cancel the order.",
    "The system shall allow user to change shipping, payment method.",
    "The system shall notify the user about any changes made to the order.",
    "The system shall display the reviews and ratings of each product, when it is selected.",
    "The system shall enable the user to enter their reviews and ratings.",
    "The system shall display all the available financing options.",
    "The system shall allow user to select the financing option.",
    "The system shall notify the user about the financing request.",
    "The system shall allow user to view detailed sitemap.",
    "The system shall display all the available promotions to the user.",
    "The system shall allow user to select available promotion.",
    "The system shall allow user to confirm the purchase.",
    "The system shall enable user to enter the payment information.",
    #Capterra - Microsoft outlook
    "The system shall display search results without duplicate emails and highlight matching keywords in subject and body.",
    "The system shall support single sign-on (SSO) via Microsoft account across external services such as e-commerce platforms.",
    "The system shall load inbox and calendar views within 3 seconds, even for mailboxes containing up to 10,000 emails.",
    #Google
    "The system must send a confirmation email after an order is placed.",
    "The system must allow users to register an account by entering their email and password.",
    "The system must respond within 2 seconds to user interactions.",
    "The system must be available during standard business hours.",
    "The system must provide access to complete patient medical records."
]

# Create CSV and write header
with open('requirements_dependencies.csv', mode='w', newline='', encoding='utf-8') as csvfile:
    writer = csv.writer(csvfile)
    writer.writerow(["Requirement Index", "Requirement", "Token", "Head", "Dependency Label", "POS", "Head POS"])

    # Process each requirement
    for idx, req in enumerate(requirements):
        doc = nlp(req)
        for token in doc:
            writer.writerow([
                idx,
                req,
                token.text,
                token.head.text,
                token.dep_,
                token.pos_,
                token.head.pos_
            ])


